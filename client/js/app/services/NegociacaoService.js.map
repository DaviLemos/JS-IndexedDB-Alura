{"version":3,"sources":["../../app_es6/services/NegociacaoService.js"],"names":["HttpService","ConnectionFactory","NegociacaoDao","Negociacao","NegociacaoService","_http","get","then","negociacoes","map","objeto","Date","data","quantidade","valor","catch","erro","console","log","Error","Promise","all","obterNegociacoesDaSemana","obterNegociacoesDaAnterior","obterNegociacoesDaRetrasada","peridos","reduce","arrayAchatado","array","concat","negociacao","getConnection","connection","dao","adiciona","listaTodos","apagaTodos","listaAtural","obterNegociacoes","filter","some","negociacaoExistente","isEquals"],"mappings":"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","file":"NegociacaoService.js","sourcesContent":["import { HttpService } from './HttpService';\r\nimport { ConnectionFactory } from './ConnectionFactory';\r\nimport { NegociacaoDao } from '../dao/NegociacaoDao';\r\nimport { Negociacao } from '../models/Negociacao';\r\n\r\nexport class NegociacaoService {\r\n  constructor() {\r\n    this._http = new HttpService();\r\n  }\r\n\r\n  obterNegociacoesDaSemana() {\r\n    return this._http\r\n      .get('negociacoes/semana')\r\n      .then((negociacoes) =>\r\n        negociacoes.map(\r\n          (objeto) =>\r\n            new Negociacao(\r\n              new Date(objeto.data),\r\n              objeto.quantidade,\r\n              objeto.valor\r\n            )\r\n        )\r\n      )\r\n      .catch((erro) => {\r\n        console.log(erro);\r\n        throw new Error('Não foi possível obter as negociações da semana');\r\n      });\r\n  }\r\n\r\n  obterNegociacoesDaAnterior() {\r\n    return this._http\r\n      .get('negociacoes/anterior')\r\n      .then((negociacoes) =>\r\n        negociacoes.map(\r\n          (objeto) =>\r\n            new Negociacao(\r\n              new Date(objeto.data),\r\n              objeto.quantidade,\r\n              objeto.valor\r\n            )\r\n        )\r\n      )\r\n      .catch((erro) => {\r\n        console.log(erro);\r\n        throw new Error(\r\n          'Não foi possível obter as negociações da semana anterior'\r\n        );\r\n      });\r\n  }\r\n\r\n  obterNegociacoesDaRetrasada() {\r\n    return this._http\r\n      .get('negociacoes/retrasada')\r\n      .then((negociacoes) =>\r\n        negociacoes.map(\r\n          (objeto) =>\r\n            new Negociacao(\r\n              new Date(objeto.data),\r\n              objeto.quantidade,\r\n              objeto.valor\r\n            )\r\n        )\r\n      )\r\n      .catch((erro) => {\r\n        console.log(erro);\r\n        throw new Error(\r\n          'Não foi possível obter as negociações da semana retrasada'\r\n        );\r\n      });\r\n  }\r\n\r\n  obterNegociacoes() {\r\n    return Promise.all([\r\n      this.obterNegociacoesDaSemana(),\r\n      this.obterNegociacoesDaAnterior(),\r\n      this.obterNegociacoesDaRetrasada(),\r\n    ])\r\n      .then((peridos) => {\r\n        let negociacoes = peridos.reduce(\r\n          (arrayAchatado, array) => arrayAchatado.concat(array),\r\n          []\r\n        );\r\n        return negociacoes;\r\n      })\r\n      .catch((erro) => {\r\n        throw new Error(erro);\r\n      });\r\n  }\r\n\r\n  cadastra(negociacao) {\r\n    return ConnectionFactory.getConnection()\r\n      .then((connection) => new NegociacaoDao(connection))\r\n      .then((dao) => dao.adiciona(negociacao))\r\n      .then(() => 'Negociação adicionada com sucesso!')\r\n      .catch((erro) => {\r\n        console.log(erro);\r\n        throw new Error('Não foi possível adicionar a negociação');\r\n      });\r\n  }\r\n\r\n  lista() {\r\n    return ConnectionFactory.getConnection()\r\n      .then((connection) => new NegociacaoDao(connection))\r\n      .then((dao) => dao.listaTodos())\r\n      .catch((erro) => {\r\n        console.log(erro);\r\n        throw new Error('Não foi possível obter as negociações');\r\n      });\r\n  }\r\n\r\n  apaga() {\r\n    return ConnectionFactory.getConnection()\r\n      .then((connection) => new NegociacaoDao(connection))\r\n      .then((dao) => dao.apagaTodos())\r\n      .then(() => 'Negociações apagadas com sucesso')\r\n      .catch((erro) => {\r\n        console.log(erro);\r\n        throw new Error('Não foi possível apagar as negociações');\r\n      });\r\n  }\r\n\r\n  importa(listaAtural) {\r\n    return this.obterNegociacoes()\r\n      .then((negociacoes) =>\r\n        negociacoes.filter(\r\n          (negociacao) =>\r\n            !listaAtural.some((negociacaoExistente) =>\r\n              negociacao.isEquals(negociacaoExistente)\r\n            )\r\n        )\r\n      )\r\n      .catch((erro) => {\r\n        console.log(erro);\r\n        throw new Error('Não foi possivel buscar negociações para importar');\r\n      });\r\n  }\r\n}\r\n"]}